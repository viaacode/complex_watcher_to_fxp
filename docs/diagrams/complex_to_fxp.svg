<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="696px" preserveAspectRatio="none" style="width:1484px;height:696px;background:#FFFFFF;" version="1.1" viewBox="0 0 1484 696" width="1484px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="311" x="585" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="301" x="590" y="32.9951">FTP ingest - Complex to FXP Diagram</text><ellipse cx="740.5" cy="57.2969" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><path d="M803.5,91.7148 L803.5,100.2813 L783.5,104.2813 L803.5,108.2813 L803.5,116.8477 A0,0 0 0 0 803.5,116.8477 L905.5,116.8477 A0,0 0 0 0 905.5,116.8477 L905.5,101.7148 L895.5,91.7148 L803.5,91.7148 A0,0 0 0 0 803.5,91.7148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M895.5,91.7148 L895.5,101.7148 L905.5,101.7148 L895.5,91.7148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="809.5" y="108.7817">inotify event</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="697.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="707.5" y="108.4355">File closed</text><path d="M400,145.6836 L400,170.8164 A0,0 0 0 0 400,170.8164 L578,170.8164 A0,0 0 0 0 578,170.8164 L578,163.6836 L598,158.25 L578,155.6836 L578,155.6836 L568,145.6836 L400,145.6836 A0,0 0 0 0 400,145.6836 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M568,145.6836 L568,155.6836 L578,155.6836 L568,145.6836 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="406" y="162.7505">Filter on .zip or .complex</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="285" x="598" y="141.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="261" x="612" y="162.4043">if ext in ('.complex', '.COMPLEX', '.zip', '.zip')</text><path d="M20,352.1055 L20,377.2383 L219,377.2383 L219,362.1055 L209,352.1055 L20,352.1055 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M209,352.1055 L209,362.1055 L219,362.1055 L209,352.1055 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="26" y="369.1724">config.yml read_mets: True</text><path d="M1259,352.1055 L1259,377.2383 L1462,377.2383 L1462,362.1055 L1452,352.1055 L1259,352.1055 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1452,352.1055 L1452,362.1055 L1462,362.1055 L1452,352.1055 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="1265" y="369.1724">config.yml read_mets: False</text><polygon fill="#F1F1F1" points="693.5,195.2344,787.5,195.2344,799.5,207.2344,787.5,219.2344,693.5,219.2344,681.5,207.2344,693.5,195.2344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="693.5" y="211.0425">Get MAM name?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="660.5" y="204.6401">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="799.5" y="204.6401">no</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="170" x="395.5" y="229.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="150" x="405.5" y="250.373">Read mets.xml find CP_ID</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="263" x="349" y="283.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="243" x="359" y="304.3418">Query org api get mam name from or-id</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="216" x="372.5" y="352.1719"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="196" x="382.5" y="373.3105">Set destination path /mam_name</text><polygon fill="#F1F1F1" points="467,407.2383,494,407.2383,506,419.2383,494,431.2383,467,431.2383,455,419.2383,467,407.2383" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="27" x="467" y="423.0464">error</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="434" y="416.644">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="506" y="416.644">no</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="233" x="239" y="441.2383"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="249" y="462.377">AMQP routing_key complex_err_fxp</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="492" y="441.2383"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="207" x="502" y="462.377">AMQP routing_key complex_to_fxp</text><polygon fill="#F1F1F1" points="480.5,481.207,492.5,493.207,480.5,505.207,468.5,493.207,480.5,481.207" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="223" x="889" y="229.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="899" y="250.373">keep default target dir in fxp msg</text><polygon fill="#F1F1F1" points="987,283.2031,1014,283.2031,1026,295.2031,1014,307.2031,987,307.2031,975,295.2031,987,283.2031" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="27" x="987" y="299.0112">error</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="954" y="292.6089">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1026" y="292.6089">no</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="233" x="759" y="317.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="769" y="338.3418">AMQP routing_key complex_err_fxp</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="227" x="1012" y="317.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="207" x="1022" y="338.3418">AMQP routing_key complex_to_fxp</text><polygon fill="#F1F1F1" points="1000.5,357.1719,1012.5,369.1719,1000.5,381.1719,988.5,369.1719,1000.5,357.1719" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#F1F1F1" points="740.5,511.207,752.5,523.207,740.5,535.207,728.5,523.207,740.5,511.207" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="695" y="555.207"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="705" y="576.3457">Publish msg</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="670" y="609.1758"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="121" x="680" y="630.3145">FXP amqp Exchange</text><ellipse cx="740.5" cy="674.1445" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="740.5" cy="674.1445" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="740.5" y1="67.2969" y2="87.2969"/><polygon fill="#181818" points="736.5,77.2969,740.5,87.2969,744.5,77.2969,740.5,81.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="740.5" y1="121.2656" y2="141.2656"/><polygon fill="#181818" points="736.5,131.2656,740.5,141.2656,744.5,131.2656,740.5,135.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="480.5" y1="263.2031" y2="283.2031"/><polygon fill="#181818" points="476.5,273.2031,480.5,283.2031,484.5,273.2031,480.5,277.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="480.5" y1="317.1719" y2="352.1719"/><polygon fill="#181818" points="476.5,342.1719,480.5,352.1719,484.5,342.1719,480.5,346.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="455" x2="355.5" y1="419.2383" y2="419.2383"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="355.5" y1="419.2383" y2="441.2383"/><polygon fill="#181818" points="351.5,431.2383,355.5,441.2383,359.5,431.2383,355.5,435.2383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="506" x2="605.5" y1="419.2383" y2="419.2383"/><line style="stroke:#181818;stroke-width:1.0;" x1="605.5" x2="605.5" y1="419.2383" y2="441.2383"/><polygon fill="#181818" points="601.5,431.2383,605.5,441.2383,609.5,431.2383,605.5,435.2383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="355.5" y1="475.207" y2="493.207"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="468.5" y1="493.207" y2="493.207"/><polygon fill="#181818" points="458.5,489.207,468.5,493.207,458.5,497.207,462.5,493.207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="605.5" x2="605.5" y1="475.207" y2="493.207"/><line style="stroke:#181818;stroke-width:1.0;" x1="605.5" x2="492.5" y1="493.207" y2="493.207"/><polygon fill="#181818" points="502.5,489.207,492.5,493.207,502.5,497.207,498.5,493.207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="480.5" y1="386.1406" y2="407.2383"/><polygon fill="#181818" points="476.5,397.2383,480.5,407.2383,484.5,397.2383,480.5,401.2383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975" x2="875.5" y1="295.2031" y2="295.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="875.5" x2="875.5" y1="295.2031" y2="317.2031"/><polygon fill="#181818" points="871.5,307.2031,875.5,317.2031,879.5,307.2031,875.5,311.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1026" x2="1125.5" y1="295.2031" y2="295.2031"/><line style="stroke:#181818;stroke-width:1.0;" x1="1125.5" x2="1125.5" y1="295.2031" y2="317.2031"/><polygon fill="#181818" points="1121.5,307.2031,1125.5,317.2031,1129.5,307.2031,1125.5,311.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="875.5" x2="875.5" y1="351.1719" y2="369.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="875.5" x2="988.5" y1="369.1719" y2="369.1719"/><polygon fill="#181818" points="978.5,365.1719,988.5,369.1719,978.5,373.1719,982.5,369.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1125.5" x2="1125.5" y1="351.1719" y2="369.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="1125.5" x2="1012.5" y1="369.1719" y2="369.1719"/><polygon fill="#181818" points="1022.5,365.1719,1012.5,369.1719,1022.5,373.1719,1018.5,369.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1000.5" x2="1000.5" y1="263.2031" y2="283.2031"/><polygon fill="#181818" points="996.5,273.2031,1000.5,283.2031,1004.5,273.2031,1000.5,277.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.5" x2="480.5" y1="207.2344" y2="207.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="480.5" y1="207.2344" y2="229.2344"/><polygon fill="#181818" points="476.5,219.2344,480.5,229.2344,484.5,219.2344,480.5,223.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="799.5" x2="1000.5" y1="207.2344" y2="207.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1000.5" x2="1000.5" y1="207.2344" y2="229.2344"/><polygon fill="#181818" points="996.5,219.2344,1000.5,229.2344,1004.5,219.2344,1000.5,223.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="480.5" y1="505.207" y2="523.207"/><line style="stroke:#181818;stroke-width:1.0;" x1="480.5" x2="728.5" y1="523.207" y2="523.207"/><polygon fill="#181818" points="718.5,519.207,728.5,523.207,718.5,527.207,722.5,523.207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1000.5" x2="1000.5" y1="381.1719" y2="523.207"/><line style="stroke:#181818;stroke-width:1.0;" x1="1000.5" x2="752.5" y1="523.207" y2="523.207"/><polygon fill="#181818" points="762.5,519.207,752.5,523.207,762.5,527.207,758.5,523.207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="740.5" y1="175.2344" y2="195.2344"/><polygon fill="#181818" points="736.5,185.2344,740.5,195.2344,744.5,185.2344,740.5,189.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="740.5" y1="535.207" y2="555.207"/><polygon fill="#181818" points="736.5,545.207,740.5,555.207,744.5,545.207,740.5,549.207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="740.5" y1="589.1758" y2="609.1758"/><polygon fill="#181818" points="736.5,599.1758,740.5,609.1758,744.5,599.1758,740.5,603.1758" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="740.5" y1="643.1445" y2="663.1445"/><polygon fill="#181818" points="736.5,653.1445,740.5,663.1445,744.5,653.1445,740.5,657.1445" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[9a86d55ec8258bbe04cdee38b8615a67]
@startuml
title FTP ingest - Complex to FXP Diagram 


start

:File closed; 
note right: inotify event 

: if ext in ('.complex', '.COMPLEX', '.zip', '.zip'); 
note left: Filter on .zip or .complex

if (Get MAM name?) then (yes)
   note left: config.yml read_mets: True 
  :Read mets.xml find CP_ID;
  :Query org api get mam name from or-id;
  :Set destination path /mam_name;
  if (error)then (yes)
  :AMQP routing_key complex_err_fxp;
  else (no)
  :AMQP routing_key complex_to_fxp;
  endif
else (no)
   note right: config.yml read_mets: False

  :keep default target dir in fxp msg;
    if (error)then (yes)
  :AMQP routing_key complex_err_fxp;
  else (no)
  :AMQP routing_key complex_to_fxp;
  endif
endif
:Publish msg;
:FXP amqp Exchange;

stop
@enduml

PlantUML version 1.2022.8beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>